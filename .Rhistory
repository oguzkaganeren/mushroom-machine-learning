mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
summary(mushroom)
library(corrplot)
correlations <- cor(mushroom[,2:dim(mushroom)[2]])
dim(mushroom)[2]
correlations <- cor(mushroom[,2:dim(mushroom)[2]-1])
correlations <- cor(mushroom[,2:dim(mushroom)[2]])
summary(mushroom)
correlations <- cor(mushroom[,2:dim(mushroom)[2]])
correlations <- cor(mushroom[,3:dim(mushroom)[2]])
correlations <- cor(mushroom[,2:dim(mushroom)[2]]-1)
correlations <- cor(mushroom[,2:dim(mushroom)[2]-1])
correlations <- cor(mushroom[,3:dim(mushroom)[2]-1])
summary(mushroom)
correlations <- cor(mushroom[,2:22])
correlations <- cor(mushroom[,2:21])
correlations <- cor(mushroom[,2:12])
correlations <- cor(mushroom[,2:13])
correlations <- cor(mushroom[,2:16])
correlations <- cor(mushroom[,2:17])
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", NULL, "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "NULL", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", NA, "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
#include dataset from disk
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
drops <- c("veil_type")
mushroom[ , !(names(mushroom) %in% drops)]
mushroom
mushroom <- mushroom[ , !(names(mushroom) %in% drops)]
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
correlations <- cor(mushroom[,2:dim(mushroom)[2]-1])
summary(mushroom)
correlations <- cor(mushroom[,2:dim(mushroom)[2]])
corrplot(correlations, method="circle")
#visualizing data
par(mfrow=c(1,dim(mushroom)[2]))
for(i in 1:dim(mushroom)[2]) {
hist(mushroom[,i], main=names(mushroom)[i])
}
for(i in 2:dim(mushroom)[2]) {
hist(mushroom[,i], main=names(mushroom)[i])
}
#pairs
pairs(mushroom, col=mushroom$edibility)#take a long time
# Logistics Regression training and test
library(caret)
install.packages(c("caret", "ggplot2"))
library(caret)
library(caret)
inTrain <- createDataPartition(y = mushroom$edibility, p = .80, list = FALSE)
training_mushroom <- mushroom[inTrain,]# %80
test_mushroom <- mushroom[-inTrain,] # %20
summary(mushroom)
#there is a problem to solve
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color
ring_number + ring_type + spore_print_color +
population + habitat,
data = training_mushroom,
family = binomial)#missing some columns
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color
ring_number + ring_type + spore_print_color +
population + habitat
data = training_mushroom,
family = binomial)#missing some columns
#there is a problem to solve
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color
ring_number + ring_type + spore_print_color + population + habitat,
data = training_mushroom,
family = binomial)#missing some columns
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = training_mushroom,
family = binomial)#missing some columns
View(glm.fit)
summary(glm.fit)
glm.probs <- predict(glm.fit,type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 0.5, "Up", "Down")
glm.pred <- ifelse(glm.probs > 0.5, "Poison", "edibility")
glm.pred
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial)#missing some columns
summary(glm.fit)
#there is a problem to solve
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial,
subset = training_mushroom)#missing some columns
#there is a problem to solve
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial,
subset = inTrain)#missing some columns
summary(glm.fit)
glm.probs <- predict(glm.fit,type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 0.5, "Poison", "edibility")
attach(mushroom)
table(glm.pred,edibility)
glm.probs <- predict(glm.fit,
newdata = mushroom[!inTrain,],
type = "response")
glm.probs <- predict(glm.fit,
newdata = mushroom[inTrain,],
type = "response")
glm.probs <- predict(glm.fit,
newdata = test_mushroom,
type = "response")
glm.probs <- predict(glm.fit,
newdata = test_mushroom,
type = "response")
glm.probs <- predict(glm.fit,
newdata = training_mushroom,
type = "response")
glm.probs <- predict(glm.fit,
newdata = test_mushroom,
type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 0.5, "Poison", "edibility")
attach(mushroom)
table(glm.pred,edibility)
columnNames <- c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names= columnNames
) # there are missing value so it gets warning
drops <- c("veil_type")
mushroom <- mushroom[ , !(names(mushroom) %in% drops)] #remove veil_type
# the missing value graph
#install.packages("Amelia")
library(Amelia)
missmap(mushroom, main = "Missing values vs observed")
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
par(mfrow=c(1,dim(mushroom)[2]))
for(i in 2:dim(mushroom)[2]) {
hist(mushroom[,i], main=names(mushroom)[i])
}
install.packages("corrplot")
# Logistics Regression training and test
#install.packages("corrplot")
library(caret)
inTrain <- createDataPartition(y = mushroom$edibility, p = .80, list = FALSE)
training_mushroom <- mushroom[inTrain,]# %80
test_mushroom <- mushroom[-inTrain,] # %20
summary(mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial,
subset = inTrain)
summary(glm.fit)
x <- Smarket[,2:dim(mushroom)[2]]
x <- mushroom[,2:dim(mushroom)[2]]
y <- mushroom[,1]
scales <- list(x=list(relation="free"), y=list(relation="free"))
featurePlot(x=x, y=y, plot="density", scales=scales)
summary(mushroom)
#there is a problem to solve
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial,
subset = inTrain)
summary(glm.fit)
glm.probs <- predict(glm.fit,
newdata = test_mushroom,
type = "response")
glm.probs[1:5]
glm.probs <- predict(glm.fit, type = "response")
glm.probs[1:5]
View(mushroom)
View(mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat,
data = mushroom,
family = binomial,
subset = inTrain)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
install.packages("arm")
#install.packages("arm")
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
#install.packages("arm")
library(arm)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
summary(glm.fit)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +  gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
summary(glm.fit)
summary(fit)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
summary(fit)
glm.probs <- predict(glm.fit, type = "response")
# Logistics Regression training and test
#install.packages("corrplot")
library(caret)
glm.probs <- predict(fit, type = "response")
glm.probs[1:5]
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
summary(fit)
glm.probs <- predict(fit, type = "response")
glm.probs[1:5]
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
summary(fit)
glm.probs <- predict(fit, type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 7, "Poison", "edibility")
attach(mushroom)
table(glm.pred,edibility)
summary(fit)
display(fit)
summary(fit)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial",control=glm.control(maxit=1))
summary(fit)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size + veil_color + gill_attachement
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial",control=glm.control(maxit=1))
fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size + veil_color + gill_attachement
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial",control=glm.control(maxit=1))
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size + veil_color + gill_attachement +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial",control=glm.control(maxit=1))
summary(fit)
glm.probs <- predict(fit, type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 7, "Poison", "edibility")
attach(mushroom)
table(glm.pred,edibility)
mean(glm.pred == edibility)
glm.pred <- ifelse(glm.probs > 7, "Poison", "edibility")
mean(glm.pred == edibility)
fit <- bayesglm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring +
ring_number + ring_type + spore_print_color + population + habitat, data=mushroom, family="binomial")
glm.probs <- predict(fit, type = "response")
glm.probs[1:5]
glm.pred <- ifelse(glm.probs > 7, "Poison", "edibility")
mean(glm.pred == edibility)
table(glm.pred,edibility)
mean(glm.pred == e)
mean(glm.pred == edibility)
