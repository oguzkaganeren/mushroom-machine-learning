sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
))
mushroom[, 1:2] <- sapply(mushroom[, 1:2], as.factor)
View(mushroom)
mushroom[, 1:3] <- sapply(mushroom[, 1:3], as.factor)
View(mushroom)
mushroom[, 1:3] <- sapply(mushroom[, 1:3], as.numeric)
mushroom[, c(3,6:15,37)] <- sapply(mushroom[, c(3,6:15,37)], as.numeric)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
))
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
View(mushroom)
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
normFunc <- function(x){(as.integer(x)-mean(as.integer(x), na.rm = T))/sd(as.integer(x), na.rm = T)}
mushroom[2:23] <- apply(mushroom[2:23], 2, normFunc)
View(mushroom)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
))
View(mushroom)
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
normFunc <- function(x){(as.integer(x)-mean(as.integer(x), na.rm = T))/sd(as.integer(x), na.rm = T)}
mushroom[2:23] <- apply(mushroom[2:23], 2, normFunc)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
## categoric to numeric without target
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
#replace NA values to columns mode
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
sum(is.na(mushroom$stalk_root))   #no NA values
normFunc <- function(x){(as.integer(x)-mean(as.integer(x), na.rm = F))/sd(as.integer(x), na.rm = F)}
mushroom[2:23] <- apply(mushroom[2:23], 2, normFunc)
install.packages("amelia")
install.packages("Amelia")
#library(tidyverse)
#install.packages("tidyverse")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
## categoric to numeric without target
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
#showing missing values with a graph
library(Amelia)
#install.packages("Amelia")
missmap(mushroom, main = "Missing values vs observed")
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
missmap(mushroom, main = "Missing values vs observed")
#training and test
training_mushroom <- sample(1:nrow(mushroom), 0.8*nrow(mushroom))  # %80
test_mushroom <- mushroom[-training_mushroom,] # %20
View(test_mushroom)
#training and test
training_mushroom <- sample_n(mushroom, 0.8*nrow(mushroom))
#training and test
library(data.table)
DT_mush <- data.table(mushroom)
View(mushroom)
#training and test
mushroom[ sample(mushroom , 0.8*nrow(mushroom) ) , ]
#training and test
mushroom[ sample(mushroom$edibility , 0.8*nrow(mushroom) ) , ]
#training and test
training_mushroom <- mushroom[ sample(mushroom$edibility , 0.8*nrow(mushroom) ) , ]
View(training_mushroom)
test_mushroom <- mushroom[-training_mushroom,] # %20
View(test_mushroom)
View(mushroom)
# Logistics Regression
summary(mushroom)
View(mushroom)
# Logistics Regression
head(mushroom)
# Logistics Regression
summary(mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface
data = mushroom,
family = binomial,
subset = training_mushroom)
glm.fit <- glm(edibility ~ capshape + capsurface
data = mushroom,
family = binomial,
subset = training_mushroom)
glm.fit <- glm(edibility ~ capshape + capsurface,
data = mushroom,
family = binomial,
subset = training_mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface,
data = mushroom,
family = binomial,
subset = training_mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_type + veil_color +
ring_number + ring_type + spore_print_color +
population + habitat,
data = mushroom,
family = binomial,
subset = training_mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_type + veil_color +
ring_number + ring_type + spore_print_color +
population + habitat,
data = mushroom,
family = binomial)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
## categoric to numeric without target
mushroom$cap_shape <- factor(mushroom$cap_shape)
View(mushroom)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
mushroom$cap_shape.f <- factor(mushroom$cap_shape)
contrasts(mushroom$cap_shape.f)
summary(mushroom)
#library(tidyverse)
#install.packages("tidyverse")
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
## categoric to numeric without target
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
summary(mushroom)
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
summary(mushroom)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_type", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
)) # there are missing value so it gets warning
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
summary(mushroom)
## categoric to numeric without target
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
# Logistics Regression
summary(mushroom)
#training and test
inTrain <- createDataPartition(y = mushroom$edibility, p = .80, list = FALSE)
#training and test
library(caret)
inTrain <- createDataPartition(y = mushroom$edibility, p = .80, list = FALSE)
training_mushroom <- mushroom[inTrain,]# %80
test_mushroom <- mushroom[-inTrain,] # %20
View(training_mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_type + veil_color +
ring_number + ring_type + spore_print_color +
population + habitat,
data = training_mushroom,
family = binomial)
View(glm.fit)
dim(training_mushroom)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color +
population + habitat,
data = training_mushroom,
family = binomial)
mushroom <- read.table("agaricus-lepiota.data",
sep = ",",
na.strings = "?",
colClasses = NA,
header = FALSE,
col.names=c(
"edibility", "cap_shape", "cap_surface",
"cap_color", "bruises", "odor",
"gill_attachement", "gill_spacing", "gill_size",
"gill_color", "stalk_shape", "stalk_root",
"stalk_surface_above_ring", "stalk_surface_below_ring", "stalk_color_above_ring",
"stalk_color_below_ring", "veil_color",
"ring_number", "ring_type", "spore_print_color",
"population", "habitat"
))
Mode <- function (x, na.rm) {
xtab <- table(x)
xmode <- names(which(xtab == max(xtab)))
if (length(xmode) > 1) xmode <- ">1 mode"
return(xmode)
}
for (var in 1:ncol(mushroom)) {
mushroom[is.na(mushroom[,var]),var] <- Mode(mushroom[,var], na.rm = TRUE)
}
mushroom$cap_shape <- as.numeric(mushroom$cap_shape)
mushroom$cap_surface <- as.numeric(mushroom$cap_surface)
mushroom$cap_color <- as.numeric(mushroom$cap_color)
mushroom$bruises <- as.numeric(mushroom$bruises)
mushroom$odor <- as.numeric(mushroom$odor)
mushroom$gill_attachement <- as.numeric(mushroom$gill_attachement)
mushroom$gill_spacing <- as.numeric(mushroom$gill_spacing)
mushroom$gill_size <- as.numeric(mushroom$gill_size)
mushroom$gill_color <- as.numeric(mushroom$gill_color)
mushroom$stalk_shape <- as.numeric(mushroom$stalk_shape)
mushroom$stalk_root <- as.numeric(mushroom$stalk_root)
mushroom$stalk_surface_above_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_surface_below_ring <- as.numeric(mushroom$cap_shape)
mushroom$stalk_color_above_ring <- as.numeric(mushroom$stalk_color_above_ring)
mushroom$stalk_color_below_ring <- as.numeric(mushroom$stalk_color_below_ring)
mushroom$veil_type <- as.numeric(mushroom$veil_type)
mushroom$veil_color <- as.numeric(mushroom$veil_color)
mushroom$ring_number <- as.numeric(mushroom$ring_number)
mushroom$ring_type <- as.numeric(mushroom$ring_type)
mushroom$spore_print_color <- as.numeric(mushroom$spore_print_color)
mushroom$population <- as.numeric(mushroom$population)
mushroom$habitat <- as.numeric(mushroom$habitat)
inTrain <- createDataPartition(y = mushroom$edibility, p = .80, list = FALSE)
training_mushroom <- mushroom[inTrain,]# %80
test_mushroom <- mushroom[-inTrain,] # %20
glm(Sex.f ~ Bwt + Hwt, data=training, family=binomial)
glm.fit <- glm(edibility ~ cap_shape + cap_surface + cap_color + bruises + odor +
gill_attachement + gill_spacing + gill_size +
gill_color + stalk_shape + stalk_root +
stalk_surface_above_ring + stalk_surface_below_ring + stalk_color_above_ring +
stalk_color_below_ring + veil_color +
ring_number + ring_type + spore_print_color +
population + habitat,
data = training_mushroom,
family = binomial)
